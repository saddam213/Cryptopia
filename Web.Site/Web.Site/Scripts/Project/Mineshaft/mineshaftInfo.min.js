function mineshaftDataUpdate(n){n.PoolId==poolId&&(n.Type==0?updateStatistics(n):n.Type==1?(getBlockChartData(),updateBlocks(n)):n.Type==3&&updateUserStatistics(n))}function mineshaftUserDataUpdate(n){n.PoolId==poolId&&n.Type==2&&updatePayouts(n)}function updateBlocks(n){var t=$("#blockHistory tbody"),i,r;t.find("tr > .dataTables_empty").closest("tr").remove();i=+t.find("tr:first > td:nth-child(1)").text();i>0&&(r=+(n.Height-i),t.find("tr").each(function(){var n=$(this).find("td:nth-child(6)");n.text(+n.text()+r)}));t.prepend(Mustache.render(blockTemplate,{highlight:"greenhighlight",userClass:n.Finder==miningname?"success":"",block:n.Height,luck:n.Luck.toFixed(2),luckClass:n.Luck<=100?"text-success":"",finder:n.Finder,amount:n.Amount.toFixed(8),difficulty:n.Difficulty.toFixed(8),confirmations:n.Confirmations,status:n.Status,shares:n.Shares,timestamp:toLocalTime(n.Timestamp)}));t.find("tr").length>10&&t.find("tr:last").remove()}function updatePayouts(n){var t=$("#payoutHistory tbody");t.find("tr > .dataTables_empty").closest("tr").remove();t.prepend(Mustache.render(payoutTemplate,{highlight:"greenhighlight",id:n.Id,block:n.Block,amount:n.Amount.toFixed(8),status:n.Status,shares:n.Shares,transferId:n.TransferId,timestamp:toLocalTime(n.Timestamp)}));t.find("tr").length>10&&t.find("tr:last").remove()}function updateStatistics(n){$("#difficulty").html(n.NetworkDifficulty);$("#currentBlock").html(n.CurrentBlock);$("#lastBlock").html(n.LastPoolBlock);$("#estShares").html(n.EstimatedShares.toFixed(2));$("#validShares").html(n.ValidShares.toFixed(2));$("#invalidShares").html(n.InvalidShares.toFixed(2));$("#poolEfficiency").html(getEfficiency(n.ValidShares,n.InvalidShares));$("#hashrate-pool").html(hashrateLabel(n.Hashrate));$("#hashrate-network").html(hashrateLabel(n.NetworkHashrate));$("#lastTime").html(n.LastBlockTime?moment.utc(n.LastBlockTime).local().fromNow():"N/A");$("#estTime").html(getEstimatedTime(n.UserCount,n.EstimatedTime));var t=n.BlockProgress>100?n.BlockProgress<200?"warning":"danger":"success",i=n.BlockProgress>100?100:n.BlockProgress;$("#blockProgress").css({width:i+"%"});$("#blockProgress").removeClass("progress-bar-warning progress-bar-danger progress-bar-success").addClass("progress-bar-"+t);$("#blockProgressLabel").html(n.BlockProgress+"%");$("#totalMiners").html(n.UserCount)}function getEstimatedTime(n,t){return n==0?"N/A":t>0?moment.utc().add(t,"seconds").local().fromNow():"less than a minute"}function updateUserStatistics(n){var i=$(".hashrate-user-"+n.MiningHandle),t;i.html(hashrateLabel(n.Hashrate));$(".validShares-user-"+n.MiningHandle).html(n.ValidShares);$(".invalidShares-user-"+n.MiningHandle).html(n.InvalidShares);t=$("#poolWorkers tbody");t.find(".hashrate-user-"+n.MiningHandle).length==0&&n.Hashrate>0&&(t.find("tr > .dataTables_empty").closest("tr").remove(),t.prepend(Mustache.render(workerTemplate,{highlight:"greenhighlight"+(n.MiningHandle==miningname?" success":""),username:n.MiningHandle,hashrateraw:n.Hashrate,hashrate:hashrateLabel(n.Hashrate)})));n.Hashrate==0&&(t.find(".hashrate-user-"+n.MiningHandle).closest("tr").remove(),t.find("tr").length==0&&t.prepend('<tr class="odd"><td class="dataTables_empty" valign="top" colspan="3">No active workers found<\/td><\/tr>'));t.find("tr > .dataTables_empty").length==0&&(t.find(".hash-sort").sort(function(n,t){return+t.dataset.hash-+n.dataset.hash}).appendTo(t),t.find("tr").each(function(n,t){$(t).find("td:first").text(n+1)}))}function getUserInfo(){getData("/Mineshaft/GetMineshaftUserInfo?id="+poolId,{id:poolId},function(n){$("#hashrate-user").html(hashrateLabel(n.Hashrate||0));$("#userValidShares").html(n.ValidShares.toFixed(2));$("#userInvalidShares").html(n.InvalidShares.toFixed(2));$("#userConfirmed").html(n.Confirmed.toFixed(8));$("#userUnconfirmed").html(n.Unconfirmed.toFixed(8));$("#userEfficiency").html(getEfficiency(n.ValidShares,n.InvalidShares));$("#userActiveWorkers").html(n.ActiveWorkerCount)})}function getEfficiency(n,t){return n>0&&t>0?n>t?(100-t/n*100).toFixed(2):(100-n/t*100).toFixed(2):n>0&&t==0?100..toFixed(2):0..toFixed(2)}function changeUserPool(n){openModalGet("/Mineshaft/ChangeUserPool",{poolId:n},function(n){showMessage(n);typeof updateUserWorkers=="function"&&updateUserWorkers()})}function gettingStarted(n){openModalGet("/Mineshaft/GettingStarted",{poolId:n})}$("#blockHistory").dataTable({order:[[0,"desc"]],lengthChange:!1,processing:!1,bServerSide:!0,searching:!1,paging:!0,sort:!1,scrollCollapse:!0,scrollY:"100%",sAjaxSource:"/Mineshaft/GetBlocks",fnServerParams:function(n){n.push({name:"poolId",value:poolId})},sServerMethod:"POST",info:!1,language:{emptyTable:"No blocks found."},columnDefs:[{targets:1,searchable:!1,orderable:!1,render:function(n){return n<=100?'<span class="text-success" >'+n+"%<\/span>":'<span class="" >'+n+"%<\/span>"}},{targets:8,render:function(n){return toLocalTime(n)}}],fnRowCallback:function(n,t){t[2]==miningname&&$(n).addClass("success")}});$("#payoutHistory").dataTable({order:[[1,"desc"]],lengthChange:!1,processing:!1,bServerSide:!0,searching:!1,paging:!0,sort:!1,scrollCollapse:!0,scrollY:"100%",sAjaxSource:"/Mineshaft/GetPayouts",fnServerParams:function(n){n.push({name:"poolId",value:poolId})},sServerMethod:"POST",info:!1,language:{emptyTable:"No payments found."},columnDefs:[{targets:0,visible:!1},{targets:5,render:function(n,t,i){return i[3]=="Unconfirmed"?"<i>Pending<\/i>":i[3]=="Orphan"?"N/A":n}},{targets:6,render:function(n){return toLocalTime(n)}}],fnRowCallback:function(){}});$("#poolWorkers").dataTable({order:[[0,"asc"]],lengthChange:!1,processing:!1,bServerSide:!0,searching:!1,paging:!1,sort:!1,scrollCollapse:!1,scrollY:"324px",sAjaxSource:"/Mineshaft/GetMiners",fnServerParams:function(n){n.push({name:"poolId",value:poolId})},sServerMethod:"POST",info:!1,language:{emptyTable:"No active workers found"},columnDefs:[{targets:2,visible:!1},{targets:3,iDataSort:2,render:function(n,t,i){return'<span class="hashrate-user hashrate-user-'+i[1]+'">'+hashrateLabel(i[2])+"<\/span>"}}],fnRowCallback:function(n,t){$(n).addClass("hash-sort").attr("data-hash",t[2]);t[1]==miningname&&$(n).addClass("success")}});getUserInfo();$("#lastTime").html(moment.utc($("#lastTime").html()).local().fromNow());$("#estTime").html(getEstimatedTime($("#totalMiners").html(),$("#estTime").html()));